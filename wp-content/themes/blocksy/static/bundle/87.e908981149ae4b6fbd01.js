"use strict";(self.blocksyJsonP=self.blocksyJsonP||[]).push([[87],{87:function(e,t,n){n.r(t),n.d(t,{fetchVideoBy:function(){return s},mount:function(){return y}});var o=n(679),i=n(248);function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const u={},s=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t=c({ignoreVideoOptions:!1},t);let n=ct_localizations.ajax_url+"?action=blocksy_get_image_video_component&media="+e;return t.ignoreVideoOptions&&(n+="&ignore_video_options=true"),new Promise((function(e){(function(e){return u[e]?new Promise((function(t){t(u[e]),u[e]=u[e].clone()})):new Promise((function(t){return fetch(e).then((function(n){t(n),u[e]=n.clone()}))}))})(n).then((function(t){200===t.status&&t.json().then((function(t){let{success:n,data:o}=t;n&&e(o)}))}))}))},l=function(e){e.querySelector(".ct-video-indicator").classList.add("loading"),s(e.dataset.mediaId).then((function(t){const n=document.createElement("div");n.innerHTML=t.html;const i=n.firstChild;e.insertAdjacentElement("beforeend",i);const r=e.querySelector("video,iframe"),a=function(){!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t=c({onPause:function(){},onPlay:function(){},onReady:function(){}},t),e.isListeningForStateChanges||(e.isListeningForStateChanges=!0,(0,o.pF)(e,(function(n){"pause"===n&&((0,o.Vz)(e),t.onPause()),"play"===n&&(t.onPlay(),(0,o.zT)(e)),"ready"===n&&t.onReady()})))}(r,{onPlay:function(){setTimeout((function(){e.querySelector(".ct-video-indicator").classList.remove("loading")}),120)},onReady:function(){(0,o.Kz)(r)}})};r.matches("video")?r.onloadeddata=a:r.onload=a}))},d=function(e){const t=ct_localizations.dynamic_styles_selectors.find((function(e){return".ct-media-container[data-media-id], .ct-dynamic-media[data-media-id]"===e.selector}));(0,i.Xr)(t.url).then((function(){l(e)}))};ctEvents.on("blocksy:frontend:flexy:slide-change",(function(e){let{instance:t,payload:n}=e;[...t.sliderContainer.querySelectorAll("video,iframe")].map((function(e){return(0,o.r)(e)}));const i=t.sliderContainer.children[n.currentIndex].querySelector(".ct-media-container[data-media-id], .ct-dynamic-media[data-media-id]");if(!i)return;const r=i.querySelector("video,iframe");r?(0,o.v3)(r):f(i)}));const f=function(e){if(!e.matches('[data-state*="autoplay"]'))return;let t=!0;if(e.closest(".flexy-items")){const n=e.getBoundingClientRect(),o=e.closest(".flexy-items").getBoundingClientRect();t=n.left>=o.left&&n.left<=o.left+o.width&&n.top>=o.top&&n.top<=o.top+o.height}t&&(e.removeAttribute("data-state"),d(e))},y=function(e,t){let{event:n}=t;if(!n)return void f(e);const i=e.querySelector("video,iframe");i?e.matches('[data-state="playing"]')?(0,o.r)(i):(0,o.Kz)(i):d(e)}}}]);